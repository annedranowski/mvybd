\documentclass{article}
\usepackage{basic}
% Working title: 
\title{How to compute the fusion product of MV cycles in type A}
\author{Roger Bai, Anne Dranowski, Joel Kamnitzer} 
\date{October 2020}

\begin{document}

\maketitle

\section{Players}

$G = \GL_m$. 

\begin{itemize}
    \item The ordinary affine Grassmannian $\Gr$
    \item The Beilinson--Drinfeld Grassmannian $\Grbd\to C$
    \item Partitions $\mu_i\le\lambda_i$ of $N_i$ ($i=1,2$) and $\mu = \sum \mu_i \le \lambda = \sum\lambda_i$ of $N = \sum N_i$
    \item The slices $\Gr_\mu$ and $\cW_{\mu_1,\mu_2}$ to the orbits $\Gr^\lambda$ and $(\Grbd[2])^{\lambda_1,\lambda_2}$
    \item The nilpotent and semi-nilpotent cones $\cN$ and $\cN_s$ (of matrices with eigenvalues 0 and 0 or $s\ne 0$)
    \item The slices $\TT_\mu$ and $\TT_{\mu_1,\mu_2}$ to the orbits $\OO_\lambda$ and $\OO_{\lambda_1,\lambda_2}$ 
\end{itemize}

New (?) definitions among these are as follows.
% 

%The [family of] slices [with $s$-fibre?]
%\begin{equation}
%    \cW_{\mu_1,\mu_2} = G_1 [t^{-1},(t-s)^{-1}]L_{\mu_1,\mu_2}
%\end{equation}


We define
$$L_\mu = t^\mu, L_{\mu_1, \mu_2} = t^{\mu_1} (t-s)^{\mu_2} \in G((t^{-1}))/G[t]$$

\begin{equation}
    \cW_\mu = G_1[[t^{-1}]]L_\mu \subset G((t^{-1}))/G[t]
\end{equation}
a subscheme of the thick affine Grassmannian

Note that $ L_{\mu_1, \mu_2} = (t-s)^{\mu_2} t^{-\mu_2} L_{\mu} \in \cW_\mu$
and that  $L_{\mu_1,\mu_2}\in\Grbd[2]$ is a $\CC[t]$-lattice in $\CC(t)^m$ that specializes to a $\CC\xt$-lattice in $\CC\xT^m$ away from $t = 0$ and away from $t = s$; i.e.\
\begin{equation}
    \label{eq:defWBD}
    \begin{split}
        %L_{\mu_1,\mu_2}\otimes \CC[(t-s)^{-1}] =
        L_{\mu_1,\mu_2}\otimes \CC\xt &= L_{\mu_2} \otimes \CC\xt \text{ and } \\
        %L_{\mu_1,\mu_2}\otimes\CC[t^{-1}] =
        L_{\mu_1,\mu_2}\otimes \CC\xt[t-s] &= L_{\mu_1} \otimes \CC\xt[t-s]
    \end{split}
\end{equation}
where $L_{\mu_i}$ denotes the point $t^{\mu_i}G(\cO)\in\Gr$. 
% 

The family of semi-infinite orbits 
\begin{equation}
    S_{\mu_1,\mu_2} = N_-(\CC((t^{-1}))) L_{\mu_1,\mu_2}\,. 
\end{equation}

The orbit of $\CC[t]$-lattices in $\CC(t)^m$ whose elements specialize again to $\CC\xt$-lattices in $\CC\xT^m$ away from $t = 0$ and away from $t = s$ as follows
\begin{equation}
    \label{eq:defGrBDlambda}
    \begin{split}
        (\Grbd[2])^{\lambda_1,\lambda_2} = \{L \in\Grbd[2] : 
        %L\otimes\CC[t^{-1}] 
        L \otimes_{\CC[t]} \CC\xt[t-s] 
        &\in \Gr^{\lambda_2} \text{ and } \\
        % L\otimes\CC[(s-t)^{-1}] 
        L\otimes_{\CC[t]} \CC\xt &\in \Gr^{\lambda_1} \text{ and } \\ 
        L \otimes_{\CC[t]} \CC\xt[t-a] = L_0 \text{ for all $ a \ne 0, s$} \}\,.
    \end{split}
\end{equation}

\jcom{It is important to add the condition that the lattices are trivial at $ a $.}
% 
\acom{These defining conditions are again just telling us that in the fibre over the fixed point $(0,s)\in C^{(2)}$ this set is pairs of lattices; note that we invert the indeterminates $t$ and $(t-s)$ \textit{after} specializing $(0,s)$. Could we give a more explicit characterization like $t^{N_1}(t-s)^{N_2} L_0 \subseteq L\subseteq t^{-N_1}(t-s)^{-N_2}$?}

The [family ``$\cN\otimes\CC[s]$? $\cN\times\CC$?'' of] semi-nilpotent cone[s fibred over $C = \AA^1$ with $s$-fibre] 
\begin{equation}
    \cN_s = \{A \in \mat(N) : \text{eigenvalues of } A \text{ are } 0 \text{ or }s\}\,.
\end{equation}

The [family of] slice[s $\TT_{\mu_1,\mu_2}$ fibred over $C=\AA^1$ with $s$-fibre]
\begin{equation}
    \begin{split}
        \TT_{\mu_1,\mu_2}^s = \{ B + C_s: B &\text{ is a }\mu\times\mu \text{ block matrix of zeros} \\
        &\text{except possibly in the last }\min(\mu_i,\mu_j) \\ 
        &\text{columns of the last row of each }\mu_i\times\mu_j \text{ block} \\
        &\text{and } C_s \text{ is the block diagonal matrix of}\\
        &\text{companion matrices of } t^{\mu_{1,k}}(t-s)^{\mu_{2,k}}\}\,.
    \end{split}
\end{equation}

The uppertriangular subfamily $\TT_{\mu_1,\mu_2}^{+}$ with $s$-fibre
\begin{equation}
    \TT_{\mu_1,\mu_2}^{+,s} = \{B + C_s \in \TT_{\mu_1,\mu_2} : B \in\n\}
\end{equation}
where $\n\subset\mat(N)$ is the unipotent subalgebra of uppertriangular matrices. 

\acom{or---as Joel pointed out, may be ok with:
The slice $\TT_\mu$ as defined in MVy, no change, \text{and} the family of slices $$\TT_{\mu_1,\mu_2}^{+,s} = \TT_\mu \cap \n + C_{\mu_1,\mu_2}^s$$ where 
% 
\begin{equation}
    C_s \text{ is the block diagonal matrix of companion matrices of } t^{\mu_{1,k}}(t-s)^{\mu_{2,k}}
\end{equation}
% not sure about notation

}

The [family of] orbit[s $\OO_{\lambda_1,\lambda_2}$ fibred over $C = \AA^1$ with $s$-fibre]  
\begin{equation}
    \OO_{\lambda_1,\lambda_2}^s = \{A \in \cN_s : A \text{ is conjugate to } J_{\lambda_1}\oplus (sI_{N_2} + J_{\lambda_2})\}
\end{equation}
where $J_{\lambda_i}$ is the Jordan normal form of block type $\lambda_i$ and $I_{N_2}$ is the identity matrix in $\mat(N_2)$.
% 
\section{Exposition}

\section{Rising Action} % Problem

\section{Climax}

\section{Falling Action} % Resolution

\begin{theorem}
    Let $\lambda_i\ge\mu_i$ be dominant ($i=1,2$), $\mu = \mu_1 +\mu_2$, and $\lambda =\lambda_1+\lambda_2$. 
    % I have an irrational dislike of ending sentences with subscripts --- can we fix this?
    There is an isomorphism 
    \begin{equation}
        \overline{\OO_{\lambda_1,\lambda_2}}\cap\TT_{\mu_1,\mu_2} \to \overline{(\Grbd[2])^{\lambda_1,\lambda_2}}\cap \cW_{\mu_1,\mu_2}
    \end{equation}
    got by taking a $\mu\times\mu$ block matrix $A$ in the $s$-fibre $\overline{\OO_{\lambda_1,\lambda_2}^s}\cap\TT_{\mu_1,\mu_2}^s$ on the left to the representative of the $s$-fibre on the right defined by  
    \begin{equation}
        \begin{split}
            g &= t^{\mu_1} (t-s)^{\mu_2} + a(t) \\
            a_{ij}(t) &= - \sum_{k=1}^{\mu_i} A^k_{ji} t^{k-1}
        \end{split}
    \end{equation}
    where $A^k_{ji}$ is the $k$th entry from the left of the last row of the $\mu_j\times\mu_i$ block of $A$. 
\end{theorem}

Let's call this the MVyBD isomorphism.

\begin{proof}
    The proof is fibre by fibre, so fix $s\ne 0$. \acom{Emphasize in the intro later (because this always confuses me) that by the $s$-fibre we really mean the $(0,s)$-fibre; i.e.\ its the BD Grassmannian over the second symmetric power of $C = \AA^1$; better just replace $s$-fibre by $(0,s)$-fibre everywhere it occurs.}
    \begin{enumerate}
        \item The map is well defined. In particular, it defines $\CC[t]$-lattices in $\CC(t)^m$. Moreover, these lattices break down to give pairs of lattices upon inverting $t$ or $t-s$ that have the right properties. [Copy Roger's proof]
        \item The inverse map is got by taking the matrix of multiplication by $t$.  More precisely, let $ L \in Gr^{BD} \cap \cW_\mu$.  We work with the quotient $\CC[t]^m/L$ just as in the ordinary MVy isomorphism---the only difference being $\CC\xt$ is replaced by $\CC[t]$.
\begin{enumerate}
    \item 
    We claim that 
    \begin{equation}
        \{[e_i],[te_i],\dots,[t^{\mu_{i}-1}e_i] : 1\le i \le m\}
    \end{equation}
    is a $\CC$-basis of $\CC[t]^m/L$.
    
    To see this, we use that $ L $ 
 has a $\CC[t]$-basis of the form 
    \begin{equation}
        v_i = t^{\mu_i} + \sum_{j>i} p_{ij}(t) e_j 
    \end{equation}
    with $\deg p_{ij}(t) < \mu_i = \mu_{1,i} + \mu_{2,i}$ ($1\le i\le m$).
    \acom{I don't know why this should be true. We might have to just define fibres of $\cW_{\mu_1,\mu_2}$ in this way?}
    \item $t\big|_{\CC[t]^m/L}$ will have two eigenvalues, 0 and $s$, and its generalized 0-eigenspace will have block type $\le \lambda_1$ while its generalized $s$-eigenspace will have block type $\le \lambda_2$. 
    To see this, note that there is a natural isomorphism
    $$\CC[[t]]^m/(L \otimes_{\CC[t]} \CC[[t]]) = \text{generalized $0$ eigenspace of $t$ on } \CC[t]^m/L$$
    carrying the action of $t $ to the action of $t$.
    
    The left hand side is the same thing as
    $$ \CC[[t]]^m / (L \otimes_{\CC[t]} \CC[[t]]) = (\CC[t]^m/L) \otimes_{\CC[t]} \CC[[t]] $$
    
    the defining fact that lattices satisfying Equation~\ref{eq:defGrBDlambda} equivalently satisfy 
    \begin{equation}
        \begin{split}
            t\big|_{\CC\xt^m/L_1}\text{ has Jordan type} \le \lambda_1 \\
            t\big|_{\CC\xt^m/L_2}\text{ has Jordan type} \le \lambda_2 
        \end{split}
    \end{equation}
    where recall 
    $L_i = L\otimes \CC\xt$ ??? 
    % $L_i = L\otimes \CC[(t-p_i)^{-1}]$ 
    and $p_1 = s$ while $p_2 = 0$. \acom{Somehow, restricting to an eigenspace is like inverting/forgetting the action of $t$ by any other generalized eigenvalue? Basic linear algebra? Joel?}
\end{enumerate}
    \end{enumerate}
\end{proof}



\begin{theorem}[Theorem 1 version 2]
    Let $\lambda_1,\lambda_2$ and $\mu$ 
    %be dominant
    be arbitrary, such that $\lambda = \lambda_1 + \lambda_2 \ge \mu$. Then there is an isomorphism 
    \begin{equation}
        \overline{\OO_{\lambda_1,\lambda_2}} \cap \TT_\mu \to \overline{\Grbd[2]^{\lambda_2,\lambda_2}}\cap\cW_\mu 
    \end{equation}
    defined by the same map as in Theorem 1.
\end{theorem}

\jcom{This is true as stated with the ``larger'' definition of $ \cW_\mu $.  In fact, for any $\lambda_1, \lambda_2$, it is true $ \overline{\Grbd[2]^{\lambda_2,\lambda_2}}\cap\cW_\mu $ is contained in a subset that we could call $ \cW_\mu^s$ which we could define as
$$
\cW_\mu^s = G_1[[t^{-1}]]t^\mu \cap G[t,t^{-1}, (t-s)^{-1}] / G[t]
$$
where we regard $G[t,t^{-1}, (t-s)^{-1}] / G[t] \subset G((t^{-1}))/G[t] $

The way to think about this is as follows: inside the thick affine Grassmannian we can consider the $G$-bundles trivialized away from just 0, $s$, or equivalently those lattices which become the standard lattice after tensoring with $ \CC[[t-a]] $ for any $ a \ne 0, s$.
}
\begin{corollary}
    The MVyBD isomorphism restricts to an isomorphism of subfamilies 
    \begin{equation}
        \overline{\OO_{\lambda_1,\lambda_2}}\cap\TT_{\mu_1,\mu_2}^+ \to \overline{(\Grbd[2])^{\lambda_1,\lambda_2}}\cap S_{\mu_1,\mu_2}\,. 
    \end{equation}
\end{corollary}

\begin{proof}
    Let $ A \in \overline{\OO_{\lambda_1,\lambda_2}}\cap\TT_{\mu_1,\mu_2}^+$ and let $ g $ be the polynomial matrix formed by the Mirkovic-Vybornov isomorphism.  Then the diagonal entries of $ g $ are $ t^{\mu_{1,k}} (t-s)^{\mu_{2,k}}$ and we can factor
    $$ g = (g t^{-\mu_1}(t-s)^{-\mu_2}) t^{\mu_1}(t-s)^{\mu_2} \in N[t, t^{-1}, (t-s)^{-1}] t^{\mu_1} (t-s)^{\mu_2}$$
    So we get containment in one direction.
    
    For the reverse containment, we choose $ [g] \in G\overline{(\Grbd[2])^{\lambda_1,\lambda_2}}\cap S_{\mu_1,\mu_2}$.  By the lemma below, $[g] \in \cW_\mu$ and thus it lies in the image of our map and we are done.
\end{proof}

% Define $S_{\mu_1,\mu_2}^s = N_-\xT[t^{-1}] t^{\mu_1} (t-s)^{\mu_2}$. 

\acom{is it a fibre of $S_{\mu_1,\mu_2}$ defined above?}

We could also make the following claim. 


\begin{lemma}[KWWY14]
    Let $\mu$ be dominant. Then 
    \begin{equation}
        N_{-}\xT[t^{-1}] L_\mu = N_1\xt[t^{-1}]L_\mu
    \end{equation}
    \acom{where I am not sure about the double brackets.}
\end{lemma}

\begin{lemma}%[Roger's lemma]
    Let $\mu_1,\mu_2$ be dominant and let $s\in \AA^1 - \{0\}$. Then 
    \begin{equation}
        S_{\mu_1,\mu_2}^s \subset \cW_\mu 
    \end{equation}
    where $\mu = \mu_1 + \mu_2$.
\end{lemma}

\begin{proof}
    % Copy Roger's proof.
    We have
\[
\begin{split}
    S_{\mu_1, \mu_2} & = N((t^{-1}))t^{\mu_1}(t-s)^{\mu_2} \\
     & \subset T_1[[t^{-1}]] N((t^{-1})) t^{\mu_1} (t-s)^{\mu_2} \\
     & = T_1[[t^{-1}]] N_1[[t^{-1}]] t^{\mu_1} (t-s)^{\mu_2} \qquad \text{\cite[Lemma 2.3]{kamnitzer2014yangians}}\\
     & = B_1[[t^{-1}]] t^{\mu_1} (t-s)^{\mu_2} \\
     & = B_1[[t^{-1}]] t^{\mu_1 + \mu_2} \\
     & \subset G_1[[t^{-1}]] t^{\mu_1 + \mu_2} \\
     & = W_{\mu_1 + \mu_2}
\end{split}
\]
where $B_1[[t^{-1}]] t^{\mu_1} (t-s)^{\mu_2} = B_1[[t^{-1}]] t^{\mu_1 + \mu_2}$ since 
\[
\frac{t}{t-s} = 
1 + \frac{s}{t} + \frac{s^2}{t^2} + \cdots 
\in B_1[[t^{-1}]].
\]
\end{proof}

\section{Denouement}

As an application we can compute fusion of stable MV cycles of type $\alpha_i$ for any $i \in I$. What about more general weights? Having $\kpf > 1$.

\begin{proposition}
    Given two MV cycles $Z_\tau$ and $Z_\sigma$ of type\dots 
    \begin{equation}
        Z_\tau\ast Z_\sigma 
    \end{equation}
    is found by??? 
\end{proposition}

\begin{conjecture}
    Let $Z_i \subset \overline{S^{\nu_i}\cap S^0_-}$ be an MV cycle of weight $\nu_i$ ($i = 1,2$) and put $\nu = \nu_1 + \nu_2$. 
\end{conjecture}

\bibliographystyle{alpha}
\bibliography{mvybd}

\end{document}